# SE Evidence Finder

![PowerShell](https://img.shields.io/badge/PowerShell-5.1%2B-5391FE?logo=powershell&logoColor=white)
![Python](https://img.shields.io/badge/Python-3.8%2B-3776AB?logo=python&logoColor=white)
![Platform](https://img.shields.io/badge/Platform-Windows-0078D6?logo=windows&logoColor=white)
![Modes](https://img.shields.io/badge/Modes-Copy%2FMove-brightgreen)
![Dependencies](https://img.shields.io/badge/Dependencies-None-success)

Automates collecting and organizing social-engineering evidence into a consistent folder and file naming structure under `Reports/<campaign>/Evidence/`.

This folder contains two scripts:
- `Run_Evidence_Finder.ps1` — Windows PowerShell wrapper for convenience.
- `se_evidence_finder_copy.py` — Core logic that scans, normalizes names, and copies/moves files using multi-threaded I/O.

## What It Does
- Scans a source directory (recursively) for common evidence types (images, pcap, logs, emails, audio, attachments).
- Normalizes filenames to `YYYYMMDD_HHMMSS_<type>_<shorthash>.<ext>`.
- Copies or moves files into `Reports/<campaign>/Evidence/{images,pcap,logs,emails,attachments,audio,other}` under your vault.
- Generates:
  - `Reports/<campaign>/evidence_manifest.json`
  - `Reports/<campaign>/Evidence_Index.md`
- Safe by design: in copy mode, originals remain untouched. Built-in deduplication avoids re-processing files already archived (matched by short hash).

## Requirements
- Windows with PowerShell 5.1+ or PowerShell 7+
- Python 3.8+
- No third‑party Python packages required (stdlib only)

## Quick Start
PowerShell wrapper (recommended on Windows):

```powershell
# From this folder
# Customize paths as needed
.\Run_Evidence_Finder.ps1 `
  -Src "C:\temp\raw_evidence" `
  -Vault "C:\OffsecDEV\OffsecDEV_Root\Pentest Campaign" `
  -Campaign "Example Campaign" `
  -Mode copy `
  -LogFile ".\evidence_run.log"
```

Direct Python (bypassing the wrapper):

```powershell
python se_evidence_finder_copy.py `
  --src "C:\temp\raw_evidence" `
  --vault "C:\OffsecDEV\OffsecDEV_Root\Pentest Campaign" `
  --campaign "Example Campaign" `
  --mode copy `
  --log-file ".\evidence_run.log"
```

### PowerShell Wrapper Defaults
If not overridden, `Run_Evidence_Finder.ps1` uses:
- `-Src`: `C:\temp\raw_evidence`
- `-Vault`: `C:\OffsecDEV\OffsecDEV_Root\Pentest Campaign`
- `-Campaign`: `Example Campaign`

If a local virtual environment exists at `.\.venv\Scripts\Activate.ps1`, the wrapper activates it before running Python.

### Optional Flags (wrapper forwards to Python)
- `--include-other` — include unknown extensions (goes to `other/`).
- `--max-size-mb <N>` — skip files larger than N MB.
- `--workers <N>` — number of copy threads (default auto).
- `--dry-run` — list actions without writing files.
- `--mode {copy|move}` — copy (default) or move files.
- `--log-file <path>` — write logs to a file in addition to console output.

Wrapper shortcuts:
- `-IncludeOther` maps to `--include-other`
- `-MaxSizeMB <N>` maps to `--max-size-mb`
- `-Workers <N>` maps to `--workers`
- `-DryRun` maps to `--dry-run`
- `-Mode {copy|move}` maps to `--mode`
- `-LogFile <path>` maps to `--log-file`

## Output Structure
After running, you should see something like:

```
<VAULT_ROOT>/
|-- Reports/
|   `-- <campaign>/
|       |-- Evidence/
|       |   |-- images/
|       |   |-- pcap/
|       |   |-- logs/
|       |   |-- emails/
|       |   |-- attachments/
|       |   |-- audio/
|       |   `-- other/
|       |-- evidence_manifest.json
|       `-- Evidence_Index.md
```

## Tips
- Point `--src` (or `-Src`) at the root folder that contains all raw evidence. The script scans recursively.
- For speed on large trees, use `--max-size-mb` to skip very large files and `--workers` for higher I/O parallelism.
- If you want isolation, create a venv in this folder:
  ```powershell
  python -m venv .venv
  . .\.venv\Scripts\Activate.ps1
  ```
- In move mode, duplicates already present in the destination are not moved again (source remains in place and the action is logged as deduplicated).

## Troubleshooting
- Ensure `python` points to Python 3.8+ (`python --version`).
- Verify that `--vault` exists and is the root of your vault (the script will create `Reports/<campaign>` under it).
- If PowerShell reports execution policy errors, you may need to allow local script execution (e.g., `Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass`).

---
Maintainers: update defaults in `Run_Evidence_Finder.ps1` as needed for your environment.
